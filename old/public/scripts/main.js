// Generated by CoffeeScript 1.10.0
(function($) {
  'use strict';
  $(function() {
    var PathFinder, StringBuilder, dynBg, dynContact, dynFooter, dynLoader, dynMenu, dynWork;
    dynBg = function() {
      var currentPage;
      currentPage = $('body').attr('data-page') || 'default';
      if (currentPage === 'default' || currentPage === 'contact') {
        $('body').css({
          'background-color': 'black'
        });
        return;
      }
      $('body').css({
        'background-image': 'url(\'images/background-' + currentPage + '.jpg\')',
        'background-repeat': 'no-repeat',
        'background-size': 'cover',
        'background-position': 'center center',
        'background-attachment': 'fixed'
      });
    };
    dynMenu = function() {
      var url;
      url = window.location.href.substr(window.location.href.lastIndexOf('/') + 1) || 'home';
      $('.header .navigation li a').each(function() {
        if (url === $(this).attr('href').replace('/', '')) {
          $(this).parent().addClass('active');
        }
      });
    };
    dynFooter = function() {
      var currentPage;
      currentPage = $('body').attr('data-page') || 'default';
      if (currentPage === 'default') {
        $('.footer').css({
          'position': 'relative',
          'bottom': '0px',
          'top': '20px',
          'height': '100px',
          'line-height': '100px',
          'padding-bottom': '10px'
        });
      }
    };
    dynWork = function() {
      var getWork;
      getWork = function(value) {
        var work;
        work = new StringBuilder;
        work.append('<div class="case-study">');
        work.append('<div class="case-wrapper">');
        work.append('<div class="image-wrapper">');
        work.append('<img src="{p}" alt="" class="image-preview" />'.replace('{p}', value.image_preview));
        work.append('</div>');
        work.append('<div class="study">');
        work.append('<h1>{p}</h1>'.replace('{p}', value.title));
        work.append('<p>{p}</p>'.replace('{p}', value.description));
        work.append('<ul>');
        work.append('<li><span>Date:</span> {p}</li>'.replace('{p}', value.date));
        work.append('<li><span>Tools:</span> {p}</li>'.replace('{p}', value.tools));
        work.append('</ul>');
        work.append('<a href="#">SEE IT LIVE</a>');
        work.append('</div>');
        work.append('</div>');
        work.append('</div>');
        return work.build();
      };
      $.ajax({
        type: 'POST',
        url: 'work/data'
      }).success(function(res) {
        $.each(res, function(k, v) {
          $.each(v, function(key, value) {
            $('.display-body').append(getWork(value));
          });
        });
      });
      $('.order a').on('click', function(e) {
        var displayState;
        e.preventDefault();
        displayState = $(this).attr('data-display');
        $(this).parent().find('.active').removeClass('active');
        $(this).addClass('active');
        $('.display-body').fadeOut(200, function() {
          $(this).attr('data-display', displayState);
          $(this).fadeIn(200);
        });
      });
      $(document).on('mouseenter', '.case-study', function() {
        $(this).find('.case-wrapper').each(function() {
          $(this).find('.study').animate({
            'top': '0px'
          }, 200);
        });
      });
      $(document).on('mouseleave', '.case-study', function() {
        $(this).find('.case-wrapper').each(function() {
          $(this).find('.study').animate({
            'top': '-400px'
          }, 200);
        });
      });
    };
    dynLoader = function() {
      var anim, lHTML, now;
      now = new Date;
      lHTML = new StringBuilder;
      lHTML.append('<div class="loader">');
      lHTML.append('<div class="loading-bar">');
      lHTML.append('<h1>Trinton<span>Designs</span></h1>');
      lHTML.append('<span class="progress-fade">');
      lHTML.append('<span class="progress"></span>');
      lHTML.append('</span>');
      lHTML.append('</div>');
      lHTML.append('</div>');
      $('body').append(lHTML.build());
      $('body').css({
        'overflow': 'hidden'
      });
      anim = window.performance.timing.domContentLoadedEventStart - now;
      anim = anim * -1 * 50;
      $('.loading-bar .progress').animate({
        'width': '100%'
      }, anim, function() {
        $('.loader').fadeOut(500);
        $('body').css({
          'overflow': 'auto'
        });
      });
    };
    dynContact = function() {
      var form;
      form = $('#contact-form');
      form.on('submit', function(e) {
        var budget, email, message, name, pattern;
        e.preventDefault();
        name = $(this).find('#name').val();
        email = $(this).find('#email').val();
        budget = $(this).find('#budget').val();
        message = $(this).find('#message').val();
        pattern = /.*[a-zA-Z]+.*/;
        if (name.match(pattern)) {
          console.log('hello');
        }
      });
    };
    StringBuilder = function() {
      this.string = [];
    };
    StringBuilder.prototype = {
      append: function(str) {
        this.string.push(str);
      },
      build: function() {
        return this.string.join('');
      }
    };
    PathFinder = (function() {
      var methods, url;
      methods = {};
      url = window.location.href.toLowerCase();
      methods.match = function(str, ind) {
        var path;
        path = url.match(/^(?:\/)?(.*?)(?:[\/])?$/i)[1].split('/').slice(3);
        if (str === path[ind]) {
          return true;
        }
        return false;
      };
      methods.get = function(str, ind) {
        var path;
        path = url.match(/^(?:\/)?(.*?)(?:[\/])?$/i)[1].split('/').slice(3);
        return path;
      };
      methods.debug = function(str, ind) {
        var path;
        ind = ind || 'empty';
        path = url.match(/^(?:\/)?(.*?)(?:[\/])?$/i)[1].split('/').slice(3);
        if (ind === 'empty') {
          console.log(path);
          return;
        }
        console.log(path[ind]);
      };
      return methods;
    })();
    $(document).ready(function() {
      dynBg();
      dynMenu();
      dynFooter();
      dynContact();
      dynLoader();
      if (PathFinder.match('work', 2)) {
        dynWork();
      }
    });
  });
})(jQuery);
